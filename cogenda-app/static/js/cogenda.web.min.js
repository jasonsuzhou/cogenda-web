function pop_msg(a,b,c){var d="",e="";0==c?(e="alert alert-danger",d="fa fa-times-circle sign"):1===c?(e="alert alert-warning",d="fa fa-warning sign"):2===c&&(e="alert alert-success",d="fa fa-check sign"),$("#"+a+"-container").attr("class",e),$("#"+a+"-container i").attr("class",d),$("#"+a).text(b),$("#"+a+"-container").show()}function switch_locale(a){$.ajax({type:"GET",async:!1,dataType:"json",url:"/switch/"+a,success:function(a){var b=JSON.parse(a);b.is_success&&(window.location="/article/"+b.uri)}})}function show_profile_menu(a,b,c){$("#user-profile-container").append('<a id="login-username" href="#"><span>'+a+'</span></a><ul><li><a href="/web/logout">'+c+'</a></li><li><a id="my-profile">'+b+"</a></li></ul>"),$("#my-profile").on("click",function(a){a&&a.preventDefault(),$("#password1").val(""),$("#password2").val(""),$("#userProfileModal").parsley().reset(),$("#userProfileModal").modal("show"),$("#change-password-msg-container").hide();var b=$("#login-username").text(),c=$.ajax({dataType:"json",type:"GET",url:"/user/user-profile/"+b});c.done(function(a){$("#u_name").text(a.username),$("#u_company").text(a.company),$("#u_email").text(a.email),$("#u_mobile").text(a.mobile)})})}$(document).ready(function(){var a;$.ajax({type:"GET",async:!1,dataType:"json",url:"/web/init-common-language",success:function(b){a=$.parseJSON(b)}}),$("video").mediaelementplayer({features:["playpause","progress","current","duration","tracks","volume","fullscreen"]}),locale=$("#locale").val(),locale.indexOf("zh")>=0&&(locale="zh_cn"),locale.indexOf("en")>=0&&(locale="en"),window.ParsleyValidator.setLocale(locale),a.username.trim().length>0?($("#login").hide(),show_profile_menu(a.username,a.myprofile,a.signout),$("#user-profile-container").show()):($("#login").show(),$("#user-profile-container").hide()),$(".bxslider").bxSlider({auto:!0,autoControls:!0,adaptiveHeight:!0,mode:"fade",preloadImages:"all",captions:!1}),$("#login").on("click",function(a){a&&a.preventDefault(),$("#loginModal").parsley().reset(),$("#loginModal").modal("show"),$("#user-login-msg-container").hide()}),$("#login-btn").on("click",function(b){if(b&&b.preventDefault(),$("#loginModal").parsley().validate()){var c=$("#username").val().trim(),d=$("#password").val().trim(),e=$("#client").val().trim(),f={username:c,password:d,client:e},g=$.ajax({dataType:"json",contentType:"application/json",url:"/security/authenticate",data:JSON.stringify(f),type:"POST"});g.done(function(b){var d=JSON.parse(b);return d.auth_success?($("#loginModal").modal("hide"),$("#login").hide(),show_profile_menu(c,a.myprofile,a.signout),$("#user-profile-container").show(),void(self.location.href.indexOf("article/downloads")>0&&(self.location="/article/downloads"))):void pop_msg("user-login-msg",d.msg,0)})}else console.log("Client side validate error.")}),$("#request-account").on("click",function(a){a&&a.preventDefault(),$("#username2").val(""),$("#email").val(""),$("#notes").val(""),$("#loginModal").modal("hide"),$("#requestAccountModal").parsley().reset(),$("#requestAccountModal").modal("show"),$("#request-account-msg-container").hide()}),$("#request-account-btn").on("click",function(a){if(a&&a.preventDefault(),$("#requestAccountModal").parsley().validate()){$("#request-account-btn").attr("class","btn btn-primary btn-processing");var b=$("#username2").val().trim(),c=$("#email").val().trim(),d=$("#notes").val().trim(),e={username:b,email:c,notes:d},f=$.ajax({dataType:"json",contentType:"application/json",url:"/user/request-an-account",data:JSON.stringify(e),type:"POST"});f.done(function(a){var b=JSON.parse(a);b.is_success?(pop_msg("request-account-msg",b.msg,2),setTimeout(function(){$("#requestAccountModal").modal("hide")},2e3),$("#request-account-btn").off("click")):pop_msg("request-account-msg",b.msg,1),$("#request-account-btn").attr("class","btn btn-primary btn-check")})}else console.log("Client side validate error.")}),$("#change-password-btn").on("click",function(b){if(b&&b.preventDefault(),$("#userProfileModal").parsley().validate()){var c=$("#login-username").text(),d=$("#password1").val().trim(),e=$("#password2").val().trim();if(d!==e)return void pop_msg("change-password-msg",a["Two passwords are not the same"],1);var f={username:c,password:d};$.ajax({dataType:"json",data:JSON.stringify(f),contentType:"application/json",type:"POST",url:"/user/change-password",success:function(b){b.id?pop_msg("change-password-msg",a["Password is changed successfully"],2):pop_msg("change-password-msg",a["Encounter error in server"],0)}})}}),self.location.href.indexOf("article/downloads")>0&&$.ajax({type:"GET",async:!1,dataType:"json",url:"/resources",success:function(a){for(var b=0;b<a.length;b++){var c="<tr><td >"+a[b].description+'</td><td ><a style="cursor: pointer;" class="resource-class">'+a[b].name+'<input type="hidden" value="'+a[b].id+'"></a></td></tr>';"1"===a[b].type&&$("#documentations tr:last").after(c),"2"===a[b].type&&$("#publications tr:last").after(c),"3"===a[b].type&&$("#brochures tr:last").after(c),("4"===a[b].type||"5"===a[b].type)&&$("#installers tr:last").after(c),"6"===a[b].type&&($("#private tr:last").after(c),$("#private-area").show())}}}),$(".resource-class").on("click",function(a){a&&a.preventDefault(),$("#download-msg-container").hide();var b=a.target.children[0].value,c=$.ajax({dataType:"json",type:"GET",url:"/check-resource/"+b});c.done(function(a){var b=JSON.parse(a);"undefined"==typeof b.auth_status?pop_msg("download-msg",b.msg,0):b.auth_status?self.location=b.link:(pop_msg("user-login-msg",b.msg,1),$("#loginModal").modal("show"))})})});